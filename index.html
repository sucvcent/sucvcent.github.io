<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GitHub.io Earth Debug</title>
  <style>
    body { margin: 0; background: #000; color: #fff; font-family: sans-serif; }
    h1 { text-align: center; padding: 20px; }
    #earth-container {
      width: 100%;
      height: 500px; /* ✅ 固定高度，保证可见 */
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h1>3D Earth Debug Page</h1>
  <div id="earth-container"></div>

  <script type="module">
    import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.156.1/build/three.module.js";
    import { OrbitControls } from "https://cdn.jsdelivr.net/npm/three@0.156.1/examples/jsm/controls/OrbitControls.js";

    const container = document.getElementById("earth-container");
    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.set(0, 0, 3);

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    // 光源
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(5, 3, 5);
    scene.add(light);

    const loader = new THREE.TextureLoader();

    // 白天贴图
    const earthDay = loader.load("https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg");
    // 夜晚城市灯光
    const earthNight = loader.load("https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57730/earth_lights_lrg.jpg");
    const earthMaterial = new THREE.MeshPhongMaterial({
      map: earthDay,
      emissiveMap: earthNight,
      emissive: new THREE.Color(0xffffff),
      emissiveIntensity: 1.0
    });

    const earthGeometry = new THREE.SphereGeometry(1, 64, 64);
    const earth = new THREE.Mesh(earthGeometry, earthMaterial);
    scene.add(earth);

    // 大气光晕
    const atmosphereMaterial = new THREE.MeshPhongMaterial({
      color: 0x00aaff,
      transparent: true,
      opacity: 0.2,
      side: THREE.BackSide
    });
    const atmosphereGeometry = new THREE.SphereGeometry(1.05, 64, 64);
    const atmosphere = new THREE.Mesh(atmosphereGeometry, atmosphereMaterial);
    scene.add(atmosphere);

    // 星空背景
    const starTexture = loader.load("https://threejs.org/examples/textures/galaxy_starfield.png");
    const starGeometry = new THREE.SphereGeometry(50, 64, 64);
    const starMaterial = new THREE.MeshBasicMaterial({ map: starTexture, side: THREE.BackSide });
    const stars = new THREE.Mesh(starGeometry, starMaterial);
    scene.add(stars);

    // 控制器
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    function animate() {
      requestAnimationFrame(animate);
      earth.rotation.y += 0.002;
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener("resize", () => {
      camera.aspect = container.clientWidth / container.clientHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(container.clientWidth, container.clientHeight);
    });
  </script>
</body>
</html>
